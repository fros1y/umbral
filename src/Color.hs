{-# LANGUAGE DeriveGeneric #-}

module Color where

import Utils
import GHC.Generics

data Color = Color
    { r :: Int
    , g :: Int
    , b :: Int }
    deriving (Eq, Generic, Show)

fromTuple :: Integral a => (a, a, a) -> Color
fromTuple (r, g, b) = Color r' g' b' where
    r' = fromIntegral r
    g' = fromIntegral g
    b' = fromIntegral b

clampC :: Color -> Color
clampC (Color r g b) = Color (restrict r) (restrict g) (restrict b) where
    restrict = clamp 0 255

instance Num Color where
    (Color r1 g1 b1) + (Color r2 g2 b2) = clampC $ Color (r1+r2) (g1+g2) (b1+b2)
    (Color r1 g1 b1) - (Color r2 g2 b2) = clampC $ Color (r1-r2) (g1-g2) (b1-b2)
    (Color r1 g1 b1) * (Color r2 g2 b2) = clampC $ Color (r1*r2) (g1*g2) (b1*b2)
    negate (Color r g b) = Color (-r) (-g) (-b)
    abs (Color r g b)  = Color (abs r) (abs g) (abs b)
    signum (Color r g b) = Color (signum r) (signum g) (signum b)
    fromInteger i = clampC $ Color i' i' i' where
        i' = fromIntegral i

instance Monoid Color where
    mempty = byName "black"
    mappend c1 c2 = c1 + c2

byName :: String -> Color
byName "alice blue" = fromTuple (240,248,255)
byName "antique white" = fromTuple (250,235,215)
byName "aqua marine" = fromTuple (127,255,212)
byName "aqua" = fromTuple (0, 255,255)
byName "azure" = fromTuple (240,255,255)
byName "beige" = fromTuple (245,245,220)
byName "bisque" = fromTuple (255,228,196)
byName "black" = fromTuple (0,0,0)
byName "blanched almond" = fromTuple (255,235,205)
byName "blue violet" = fromTuple (138,43,226)
byName "blue" = fromTuple (0,0,255)
byName "brown" = fromTuple (165,42,42)
byName "burly wood" = fromTuple (222,184,135)
byName "cadet blue" = fromTuple (95,158,160)
byName "chart reuse" = fromTuple (127,255,0)
byName "chocolate" = fromTuple (210,105,30)
byName "coral" = fromTuple (255,127,80)
byName "corn flower blue" = fromTuple (100,149,237)
byName "corn silk" = fromTuple (255,248,220)
byName "crimson" = fromTuple (220,20,60)
byName "cyan / aqua" = fromTuple (0, 255,255)
byName "cyan" = fromTuple (0, 255,255)
byName "dark blue" = fromTuple (0,0,139)
byName "dark cyan" = fromTuple (0, 139,139)
byName "dark golden rod" = fromTuple (184,134,11)
byName "dark gray / dark grey" = fromTuple (169,169,169)
byName "dark green" = fromTuple (0,100,0)
byName "dark khaki" = fromTuple (189,183,107)
byName "dark magenta" = fromTuple (139,0,139)
byName "dark olive green" = fromTuple (85,107,47)
byName "dark orange" = fromTuple (255,140,0)
byName "dark orchid" = fromTuple (153,50,204)
byName "dark red" = fromTuple (139,0,0)
byName "dark salmon" = fromTuple (233,150,122)
byName "dark sea green" = fromTuple (143,188,143)
byName "dark slate blue" = fromTuple (72,61,139)
byName "dark slate gray" = fromTuple (47,79,79)
byName "dark turquoise" = fromTuple (0, 206,209)
byName "dark violet" = fromTuple (148,0,211)
byName "deep pink" = fromTuple (255,20,147)
byName "deep sky blue" = fromTuple (0, 191,255)
byName "dim gray / dim grey" = fromTuple (105,105,105)
byName "dodger blue" = fromTuple (30,144,255)
byName "firebrick" = fromTuple (178,34,34)
byName "floral white" = fromTuple (255,250,240)
byName "forest green" = fromTuple (34,139,34)
byName "gainsboro" = fromTuple (220,220,220)
byName "ghost white" = fromTuple (248,248,255)
byName "gold" = fromTuple (255,215,0)
byName "golden rod" = fromTuple (218,165,32)
byName "gray / grey" = fromTuple (128,128,128)
byName "gray" = fromTuple (128,128,128)
byName "green yellow" = fromTuple (173,255,47)
byName "green" = fromTuple (0,128,0)
byName "honeydew" = fromTuple (240,255,240)
byName "hot pink" = fromTuple (255,105,180)
byName "indian red" = fromTuple (205,92,92)
byName "indigo" = fromTuple (75,0,130)
byName "ivory" = fromTuple (255,255,240)
byName "khaki" = fromTuple (240,230,140)
byName "lavender blush" = fromTuple (255,240,245)
byName "lavender" = fromTuple (230,230,250)
byName "lawn green" = fromTuple (124,252,0)
byName "lemon chiffon" = fromTuple (255,250,205)
byName "light blue" = fromTuple (173,216,230)
byName "light coral" = fromTuple (240,128,128)
byName "light cyan" = fromTuple (224,255,255)
byName "light golden rod yellow" = fromTuple (250,250,210)
byName "light gray / light grey" = fromTuple (211,211,211)
byName "light green" = fromTuple (144,238,144)
byName "light pink" = fromTuple (255,182,193)
byName "light salmon" = fromTuple (255,160,122)
byName "light sea green" = fromTuple (32,178,170)
byName "light sky blue" = fromTuple (135,206,250)
byName "light slate gray" = fromTuple (119,136,153)
byName "light steel blue" = fromTuple (176,196,222)
byName "light yellow" = fromTuple (255,255,224)
byName "lime green" = fromTuple (50,205,50)
byName "lime" = fromTuple (0,255,0)
byName "linen" = fromTuple (250,240,230)
byName "magenta / fuchsia" = fromTuple (255,0,255)
byName "maroon" = fromTuple (128,0,0)
byName "medium aqua marine" = fromTuple (102,205,170)
byName "medium blue" = fromTuple (0,0,205)
byName "medium orchid" = fromTuple (186,85,211)
byName "medium purple" = fromTuple (147,112,219)
byName "medium sea green" = fromTuple (60,179,113)
byName "medium slate blue" = fromTuple (123,104,238)
byName "medium spring green" = fromTuple (0, 250,154)
byName "medium turquoise" = fromTuple (72,209,204)
byName "medium violet red" = fromTuple (199,21,133)
byName "midnight blue" = fromTuple (25,25,112)
byName "mint cream" = fromTuple (245,255,250)
byName "misty rose" = fromTuple (255,228,225)
byName "moccasin" = fromTuple (255,228,181)
byName "navajo white" = fromTuple (255,222,173)
byName "navy" = fromTuple (0,0,128)
byName "old lace" = fromTuple (253,245,230)
byName "olive drab" = fromTuple (107,142,35)
byName "olive" = fromTuple (128,128,0)
byName "orange red" = fromTuple (255,69,0)
byName "orange" = fromTuple (255,165,0)
byName "orchid" = fromTuple (218,112,214)
byName "pale golden rod" = fromTuple (238,232,170)
byName "pale green" = fromTuple (152,251,152)
byName "pale turquoise" = fromTuple (175,238,238)
byName "pale violet red" = fromTuple (219,112,147)
byName "papaya whip" = fromTuple (255,239,213)
byName "peach puff" = fromTuple (255,218,185)
byName "peru" = fromTuple (205,133,63)
byName "pink" = fromTuple (255,192,203)
byName "plum" = fromTuple (221,160,221)
byName "powder blue" = fromTuple (176,224,230)
byName "purple" = fromTuple (128,0,128)
byName "red" = fromTuple (255,0,0)
byName "rosy brown" = fromTuple (188,143,143)
byName "royal blue" = fromTuple (65,105,225)
byName "saddle brown" = fromTuple (139,69,19)
byName "salmon" = fromTuple (250,128,114)
byName "sandy brown" = fromTuple (244,164,96)
byName "sea green" = fromTuple (46,139,87)
byName "sea shell" = fromTuple (255,245,238)
byName "sienna" = fromTuple (160,82,45)
byName "silver" = fromTuple (192,192,192)
byName "sky blue" = fromTuple (135,206,235)
byName "slate blue" = fromTuple (106,90,205)
byName "slate gray" = fromTuple (112,128,144)
byName "snow" = fromTuple (255,250,250)
byName "spring green" = fromTuple (0, 255,127)
byName "steel blue" = fromTuple (70,130,180)
byName "tan" = fromTuple (210,180,140)
byName "teal" = fromTuple (0, 128,128)
byName "thistle" = fromTuple (216,191,216)
byName "tomato" = fromTuple (255,99,71)
byName "turquoise" = fromTuple (64,224,208)
byName "violet" = fromTuple (238,130,238)
byName "wheat" = fromTuple (245,222,179)
byName "white smoke" = fromTuple (245,245,245)
byName "white" = fromTuple (255,255,255)
byName "yellow green" = fromTuple (154,205,50)
byName "yellow" = fromTuple (255,255,0)
byName _ = fromTuple (0, 0, 0)
